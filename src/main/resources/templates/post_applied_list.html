<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <title>Danh sách công việc đã ứng tuyển</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-SgOJa3DmI69IUzQ2PVdRZhwQ+dy64/BUtbMJw1MZ8t5HZApcHrRKUc4W0kG879m7" crossorigin="anonymous">

</head>
<body class="bg-gray-100">
<div>
    <nav class="bg-white shadow-sm p-4">
        <div class="container mx-auto flex justify-between items-center">
            <!-- Logo / Trang chủ -->
            <a class="text-xl font-bold text-blue-600" href="/home">Trang chủ</a>

            <!-- Nút Toggle cho mobile -->
            <button class="lg:hidden text-gray-600 focus:outline-none" id="menu-toggle">
                <i class="fas fa-bars text-xl"></i>
            </button>

            <!-- Menu chính -->
            <div class="hidden lg:flex space-x-6 items-center" id="navbar-menu">
                <a class="text-gray-700 hover:text-blue-500" href="/post/list">Danh sách bài đăng</a>
                <th:block sec:authorize="hasRole('applicant')">
                    <a class="text-gray-700 hover:text-blue-500" href="/cv/list-post-applied">Danh sách công việc đã apply</a>
                    <a class="text-gray-700 hover:text-blue-500" href="/post/postFollowed">Followed Post</a>
                    <a class="text-gray-700 hover:text-blue-500" href="/post/companyFollowed">Followed Company</a>

                </th:block>
                <th:block sec:authorize="hasRole('recruiter')">
                    <a href="/post/showFormForAdd" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition">Đăng bài</a>
                    <a href="/cv/list" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition">Duyệt CV</a>
                </th:block>

                <!-- Hiển thị nếu chưa đăng nhập -->
                <th:block th:if="${#authorization.expression('isAnonymous()')}">
                    <a class="px-4 py-2 border border-blue-500 text-blue-500 rounded hover:bg-blue-500 hover:text-white transition" href="/user/login">Đăng nhập</a>
                    <a class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition" href="/user/form-register">Đăng ký</a>
                </th:block>

                <!-- Hiển thị nếu đã đăng nhập -->
                <th:block th:if="${#authorization.expression('isAuthenticated()')}">
                    <a class="text-gray-700 hover:text-blue-500" href="/user/profile">Hồ sơ</a>
                    <form th:action="@{/logout}" method="post">
                        <button class="text-red-500 hover:text-red-600" type="submit">Đăng xuất</button>
                    </form>
                </th:block>
            </div>
        </div>
    </nav>
</div>
<div class="bg-gradient-to-r from-blue-500 to-purple-500 text-white py-8">
    <div class="container mx-auto text-center">
        <div class="text-sm">
            <a href="#" class="text-white">TRANG CHỦ</a> &gt; <span>DANH SÁCH</span>
        </div>
        <h1 class="text-4xl font-bold mt-2">Danh sách công việc đã ứng tuyển</h1>
    </div>
</div>



<div th:each="Jobapplication : ${applicationList}" class="bg-white p-6 rounded-lg shadow-md flex flex-col lg:flex-row justify-between items-center mb-6 border border-gray-200 max-w-3xl mx-auto">

    <!-- Thông tin công việc -->
    <div class="flex-1">
        <div class="text-blue-600 font-bold text-sm uppercase" th:text="${Jobapplication.post.jobType}"></div>
        <div class="text-2xl font-semibold mt-1 text-gray-800" th:text="${Jobapplication.post.title}"></div>
        <div class="text-gray-600 mt-2 flex items-center">
            <i class="fas fa-building mr-2 text-gray-500"></i>
            <span class="font-medium" th:text="${Jobapplication.post.company.name}"></span>
        </div>

        <!-- Categories nằm dưới thông tin -->
        <div class="flex flex-wrap mt-3">
            <a th:each="category : ${Jobapplication.post.categoryList}"
               th:href="@{/post/allPostByCategory(categoryId=${category.id})}"
               class="bg-blue-100 text-blue-700 text-sm px-3 py-1 rounded-full mr-2 mb-2 hover:bg-blue-200 transition">
                <span th:text="${category.name}"></span>
            </a>
        </div>
    </div>


        <span th:if="${Jobapplication.isApproved()}" class="bg-green-400 text-white px-6 py-2 rounded-lg shadow-md cursor-not-allowed">Đã duyệt</span>
        <span th:if="${!Jobapplication.isApproved()}" class="bg-red-400 text-white px-6 py-2 rounded-lg shadow-md cursor-not-allowed">Chưa duyệt</span>


</div>

<!----------------------------------------------------->



<nav aria-label="Page navigation example">
    <ul class="pagination justify-content-center">
        <li class="page-item" th:classappend="${currentPage == 1 } ? 'disabled' ">
            <a class="page-link" th:href="@{/cv/list-post-applied(page=${currentPage -1})}" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li>
        <li th:each="i : ${#numbers.sequence(1, totalPage)} " class="page-item"><a class="page-link" th:classappend="${currentPage == i} ?  'active' " th:href="@{/cv/list-post-applied(page=${i})}" th:text="${i}"></a></li>

        <li class="page-item" th:classappend="${currentPage == totalPage} ? 'disabled'">
            <a class="page-link" th:href="@{/cv/list-post-applied(page=${currentPage +1})}" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
    </ul>
</nav>

</body>
</html>